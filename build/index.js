(()=>{"use strict";new class{constructor(){this.searchField=document.getElementById("search-term"),this.searchResultDiv=document.querySelector(".search-suggestion-field"),this.searchButton=document.querySelector(".my-search-btn"),this.mySearchBox=document.querySelector(".my-search-box"),this.previousValue,this.events(),this.typingTimer}events(){this.searchField.addEventListener("keyup",this.typingLogic.bind(this)),this.searchField.addEventListener("input",()=>{this.searchResultDiv.classList.add("d-none")}),this.searchButton.addEventListener("click",this.closeSearch.bind(this)),"false"===this.mySearchBox.getAttribute("aria-hidden")&&(console.log("aria is false"),document.addEventListener("keyup",e=>{"Escape"===e.key&&(console.log("key"),this.searchButton.click())}))}closeSearch(){this.searchField.value="",this.searchResultDiv.classList.add("d-none")}typingLogic(){this.searchField.value!=this.previousValue&&(clearTimeout(this.typingTimer),this.searchField.value?this.typingTimer=setTimeout(this.getResult.bind(this),1e3):(this.searchField.innerHTML="",this.searchResultDiv.classList.add("d-none"))),this.previousValue=this.searchField.value}getResult(){fetch(magpreneur.root_url+"/wp-json/magpreneur/v1/search?term="+this.searchField.value).then(e=>{if(!e.ok)throw new Error(`HTTP error! Status: ${e.status}`);return e.json()}).then(e=>{this.searchResultDiv.classList.remove("d-none"),this.searchResultDiv.innerHTML=`\n                ${e.topics.length?'<ul class="mb-auto search-list__group py-3 px-3">':'<p class="mb-0 p-2">Match not found</p>'}\n                    ${e.topics.map(e=>`<li class="mb-1 search-list__item"><a href="${e.permalink}">${e.title}</a></li>`).join("")}\n                ${e.topics.length?"</ul>":""}\n\n                ${e.webinars.length?'<small class="webinars-search-result mb-auto py-2 px-3">Webinars</small> <ul class="mb-auto search-list__group webinars-search-list py-3 px-3">':""}\n                    ${e.webinars.map(e=>`<li class="mb-1 search-list__item"><a href="${e.permalink}">${e.title}</a>\n                        <div class="webinar-status__container">\n                            <span class="webinar-status__${"Upcoming"==e.status?"upcoming":"past"}">${e.status}</span>\n                        </div>\n                        </li>`).join("")}\n                ${e.webinars.length?"</ul>":""}\n                `}).catch(e=>{console.error("Fetch error:",e),this.searchResultDiv.classList.remove("d-none"),this.searchResultDiv.innerHTML='<p class="mb-0 p-2 text-danger">Something went wrong. Please try again later.</p>'})}},new class{constructor(){this.likeBtn=document.querySelector(".like-btn"),this.event()}event(){this.likeBtn.addEventListener("click",this.ourClickDispatcher.bind(this))}ourClickDispatcher(e){var t=e.target.closest(".like-btn");"yes"==t.getAttribute("data-exists")?this.deleteLike(t):this.createLike(t)}createLike(e){const t={postID:e.getAttribute("data-postID")};fetch(magpreneur.root_url+"/wp-json/magpreneur/v1/manageLike",{method:"POST",headers:{"Content-Type":"application/json","X-WP-Nonce":magpreneur.nonce},body:JSON.stringify(t)}).then(async e=>{if(!e.ok){let t=`HTTP error! Status: ${e.status}`;try{const s=await e.json().catch(()=>({}));s?.data?.message&&(t=s.data.message)}catch(e){}throw new Error(t)}return e.json()}).then(t=>{if(t.success){console.log("Like created:",t),e.setAttribute("data-exists","yes"),e.querySelector("svg").setAttribute("data-prefix","fas");var s=e.querySelector(".like-count"),r=parseInt(s.innerHTML,10);r++,s.innerHTML=r,e.setAttribute("data-likeID",t.data.likeID),console.log(r)}else console.error("Error:",t.data.message)}).catch(e=>{console.error("Fetch error:",e)})}deleteLike(e){const t={likeID:e.getAttribute("data-likeID")};fetch(magpreneur.root_url+"/wp-json/magpreneur/v1/manageLike",{method:"DELETE",headers:{"Content-Type":"application/json","X-WP-Nonce":magpreneur.nonce},body:JSON.stringify(t)}).then(async e=>{if(!e.ok){let t=`HTTP error! Status: ${e.status}`;try{const s=await e.json().catch(()=>({}));s?.data?.message&&(t=s.data.message)}catch(e){}throw new Error(t)}return e.json()}).then(t=>{if(t.success){console.log("Like Status:",t),e.setAttribute("data-exists","no"),e.querySelector("svg").setAttribute("data-prefix","far");var s=e.querySelector(".like-count"),r=parseInt(s.innerHTML,10);r--,s.innerHTML=r,e.setAttribute("data-likeID",""),console.log(r)}else console.error("Error:",t.data.message)}).catch(e=>{console.error("Fetch error:",e)})}}})();